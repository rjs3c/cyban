/* CyBan v1.1 | (c) 2022 by Ryan Instrell. */
const alert_banner=document.querySelector("#alert-banner"),mob_screen=window.matchMedia("(max-width: 800px)"),mob_screen_small=window.matchMedia("(max-width: 575px)"),entries=document.querySelectorAll(".entry"),children=document.querySelectorAll(".child"),entries_list_todo=document.querySelector("#todo.entries"),entries_list_pending=document.querySelector("#pending.entries"),entries_list_done=document.querySelector("#done.entries"),entries_actions_btns=document.querySelector(".entry-actions"),hide_sidebar_btn=document.querySelector("#btn-hide-sidebar"),add_form=document.querySelector("#add-entry-form"),login_form=document.querySelector("#login-form"),register_form=document.querySelector("#register-form"),show_login_password_btn=document.querySelector("#show-login-password"),show_register_password_btn=document.querySelector("#show-register-password"),show_change_password_btn=document.querySelector("#show-change-password"),filter_form=document.querySelector("#filter-menu"),sidebar=document.querySelector("#sidebar-row"),todo_count_text=document.querySelector("#todo-count"),pending_count_text=document.querySelector("#pending-count"),done_count_text=document.querySelector("#done-count"),todo_column=document.querySelector("#todo-column"),pending_column=document.querySelector("#pending-column"),done_column=document.querySelector("#done-column"),columns_row=document.querySelector(".row"),category_checkall_check=document.querySelector("#entry_category_select_all"),priority_checkall_check=document.querySelector("#entry_priority_select_all"),priority_checkboxes=document.querySelectorAll(".filter-priority-check"),category_checkboxes=document.querySelectorAll(".filter-category-check"),login_option=document.querySelector("#login-option"),logout_option=document.querySelector("#logout-option"),register_option=document.querySelector("#register-option"),account_option=document.querySelector("#account-option"),account_submenu=document.querySelector("#accountPageSubmenu"),account_form=document.querySelector("#account-form"),delete_account_btn=document.querySelector("#delete-account-btn"),executive_summary_option=document.querySelector("#exec-option"),recent_activity_option=document.querySelector("#activity-option"),performance_option=document.querySelector("#performance-option"),performance_plot=document.querySelector("#performance-plot-section"),performance_representation=document.querySelector("#data-rep-select"),performance_created_score=document.querySelector("#performance-created-section"),performance_modified_score=document.querySelector("#performance-modified-section"),performance_deleted_score=document.querySelector("#performance-deleted-section"),rss_feed_option=document.querySelector("#rss-option"),rss_feed_form=document.querySelector("#rss-form"),rss_search_form=document.querySelector("#rss-search-form"),ticket_option=document.querySelector("#tickets-option"),ticket_create_form=document.querySelector("#tickets-form"),ticket_create_section=document.querySelector("#create-ticket-section"),ticket_actions_header=document.querySelector("#tickets-action-header"),append_epoch_check=document.querySelector("#append-epoch-option"),filename_field=document.querySelector("#filename-field"),mob_up_btn=document.querySelector("#mob-mov-up"),mob_down_btn=document.querySelector("#mob-mov-down"),logs_list=document.querySelector("#logs-list"),logs_prev_btn=document.querySelector("#prev-page"),logs_next_btn=document.querySelector("#next-page"),logs_page_num=document.querySelector("#page-number"),rss_source_text=document.querySelector("#rss-source-text"),rss_list=document.querySelector("#rss-list"),rss_page_num=document.querySelector("#page-number-rss"),rss_prev_btn=document.querySelector("#prev-page-rss"),rss_next_btn=document.querySelector("#next-page-rss"),tickets_list=document.querySelector("#tickets-list"),tickets_table=document.querySelector("#tickets-table"),tickets_page_num=document.querySelector("#page-number-tickets"),tickets_prev_btn=document.querySelector("#prev-page-tickets"),tickets_next_btn=document.querySelector("#next-page-tickets"),tickets_summary_section=document.querySelector("#tickets-summary-section"),tickets_new_score=document.querySelector("#tickets-new-section"),tickets_open_score=document.querySelector("#tickets-open-section"),tickets_rejected_score=document.querySelector("#tickets-rejected-section"),tickets_resolved_score=document.querySelector("#tickets-resolved-section"),view_more_less=document.querySelector("#view-more-less"),entry_categories_more=document.querySelector("#entry-categories-more"),filter_entries_link=document.querySelector("#filter-entries-link"),columns=["#todo-column","#pending-column","#done-column"];let idle_interval,rss_data,todo_delete_buttons=[],pending_delete_buttons=[],done_delete_buttons=[],edit_forms=[],col_3_prev_state=!1,params={},mouse_mov_counter=0,mob_scroll_pos=0,page_num=1,page_num_rss=1,page_num_tickets=1,rss_length=0,performance_representation_value="chart",logs_length=0,tickets_length=0,tickets_form_open_state=!1,token="";const escapeOutput=e=>new Option(e).innerHTML,getCsrfToken=async()=>{await axios.get("/csrf").then((e=>{token=e.data["XSRF-TOKEN"]}))},getAllEntries=async e=>{const{data:t}=await axios.get("/api/entries",{params:e});let s=[],a=[],o=[];t.map((e=>{const{_id:t,entry_title:c,entry_category:r,entry_status:i,entry_priority:n,entry_depends_on:l,createdAt:d}=e;let p=`${Math.trunc(((new Date).getTime()-new Date(d).getTime())/864e5)}d`,u="";switch(n){case"low":u=`<div class="entry-priority low text-center text-uppercase bg-secondary"><p class="entry-priority-text fw-bold text-white">${escapeOutput(n)}</p></div>`;break;case"medium":u=`<div class="entry-priority medium text-center text-uppercase bg-secondary"><p class="entry-priority-text fw-bold text-white">${escapeOutput(n)}</p></div>`;break;case"high":u=`<div class="entry-priority high text-center text-uppercase bg-secondary"><p class="entry-priority-text fw-bold text-white">${escapeOutput(n)}</p></div>`}let m="",_="",h="",b="";switch(l&&(_="hide",m='<i class="child-icon fw-bold text-white-50 fas fa-child"></i>',h="child",b=`data-parent="${l}"`),i){case"todo":s.push(`<div class="col ${h} todo entry" translate="off" data-id="${t}" ${b}><div class="row"><div class="col-6"><div class="entry-category text-center text-uppercase bg-secondary"><p class="entry-category-text fw-bold text-white">${escapeOutput(r)}</p></div></div><div class="col-6">${u}</div></div><div class="entry-header text-sm-start text-wrap"><p class="entry-header-text fs-5 text-black">${escapeOutput(c)}</p></div><div class="entry-actions text-end"><div class="row"><div class="col-4 created-at text-start"><p class="date-created-text text-sm-start fw-bold text-white-50">&nbsp;&nbsp;${p}</p>${m}</div><div class="col-8"><button type="button" class="btn btn-todo-create-child btn-sm refresh ${_}" data-id="${t}" data-entry-category="${escapeOutput(r)}" data-entry-status="${escapeOutput(i)}" data-entry-priority="${escapeOutput(n)}" title="Create Child Entry"><i class="btn-create-child-text fas fa-level-down-alt"></i></button><button type="button" class="btn btn-edit btn-sm refresh" data-bs-toggle="modal" data-bs-target="#modal-todo-${t}" title="Edit Entry"><i class="btn-edit-text fas fa-edit"></i></button><button type="button" class="btn btn-todo-delete btn-sm refresh" data-id="${t}" title="Delete Entry"><i class="btn-delete-text fas fa-trash-alt"></i></button></div></div></div></div><div class="modal fade modal-edit" id="modal-todo-${t}" tabindex="-1" aria-labelled-by="modal-todo-${t}-label" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" translate="yes"><div class="modal-content fw-bold"><div class="modal-header"><h5 class="modal-title" id="modal-todo-${t}-label">Edit Entry</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><form class="edit-form" data-id="${t}"><div class="mb-3 text-start"><label for="entry_title" class="form-label">Entry Title</label><input type="text" class="form-control" id="entry_title" value="${escapeOutput(c)}" required tabindex="0" maxlength="60" placeholder="e.g. Entry Title"></div><div class="mb-3 text-start"><label for="entry_category" class="form-label">Entry Category</label><select class="form-select" id="entry_category" required><option value="control">control</option><option value="dp">data protection</option><option value="dr">disaster recovery</option><option value="event">event</option><option value="grc">governance/risk/compliance</option><option value="ir">incident response</option><option value="patch">patch</option><option value="privacy">privacy</option><option value="risk">risk</option><option value="test">test</option><option value="ta">training/awareness</option><option value="vulnerability">vulnerability</option></select></div><div class="mb-3 text-start"><label for="entry_priority" class="form-label">Entry Priority</label><select class="form-select" id="entry_priority" required><option value="low">low</option><option value="medium">medium</option><option value="high">high</option></select></div><div class="mb-3 text-start"><div class="form-check form-check-inline"><input type="radio" class="form-check-input" name="entry_status" value="todo" tabindex="3" checked><label class="form-check-label" for="todo-radio">Todo</label></div><div class="form-check form-check-inline"><input type="radio" class="form-check-input" name="entry_status" value="pending" tabindex="4"><label class="form-check-label" for="pending-radio">Pending</label></div><div class="form-check form-check-inline"><input type="radio" class="form-check-input" name="entry_status" value="done" tabindex="5"><label class="form-check-label" for="done-radio">Done</label></div></div><div class="modal-footer"><button type="submit" class="btn btn-dark" data-bs-dismiss="modal" tabindex="6">Submit</button></div></form></div></div></div></div>`.replace(/\\"/g,'"'));break;case"pending":a.push(`<div class="col ${h} pending entry" translate="off" data-id="${t}" ${b}><div class="row"><div class="col-6"><div class="entry-category text-center text-uppercase bg-secondary"><p class="entry-category-text fw-bold text-white">${escapeOutput(r)}</p></div></div><div class="col-6">${u}</div></div><div class="entry-header text-sm-start text-wrap"><p class="entry-header-text fs-5 text-black">${escapeOutput(c)}</p></div><div class="entry-actions text-end"><div class="row"><div class="col-4 created-at text-start"><p class="date-created-text text-sm-start fw-bold text-white-50">&nbsp;&nbsp;${p}</p>${m}</div><div class="col-8"><button type="button" class="btn btn-pending-create-child btn-sm refresh ${_}" data-id="${t}" data-entry-category="${escapeOutput(r)}" data-entry-status="${escapeOutput(i)}" data-entry-priority="${escapeOutput(n)}" title="Create Child Entry"><i class="btn-create-child-text fas fa-level-down-alt"></i></button><button type="button" class="btn btn-edit btn-sm refresh" data-bs-toggle="modal" data-bs-target="#modal-pending-${t}" title="Edit Entry"><i class="btn-edit-text fas fa-edit"></i></button><button type="button" class="btn btn-pending-delete btn-sm refresh" data-id="${t}" title="Delete Entry"><i class="btn-delete-text fas fa-trash-alt"></i></button></div></div></div></div><div class="modal fade modal-edit" id="modal-pending-${t}" tabindex="-1" aria-labelled-by="modal-pending-${t}-label" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" translate="yes"><div class="modal-content fw-bold"><div class="modal-header"><h5 class="modal-title" id="modal-pending-${t}-label">Edit Entry</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><form class="edit-form" data-id="${t}"><div class="mb-3 text-start"><label for="entry_title" class="form-label">Entry Title</label><input type="text" class="form-control" id="entry_title" value="${escapeOutput(c)}" required tabindex="0" maxlength="60" placeholder="e.g. Entry Title"></div><div class="mb-3 text-start"><label for="entry_category" class="form-label">Entry Category</label><select class="form-select" id="entry_category" required><option value="control">control</option><option value="dp">data protection</option><option value="dr">disaster recovery</option><option value="event">event</option><option value="grc">governance/risk/compliance</option><option value="ir">incident response</option><option value="patch">patch</option><option value="privacy">privacy</option><option value="risk">risk</option><option value="test">test</option><option value="ta">training/awareness</option><option value="vulnerability">vulnerability</option></select></div><div class="mb-3 text-start"><label for="entry_priority" class="form-label">Entry Priority</label><select class="form-select" id="entry_priority" required><option value="low">low</option><option value="medium">medium</option><option value="high">high</option></select></div><div class="mb-3 text-start"><div class="form-check form-check-inline"><input type="radio" class="form-check-input" name="entry_status" value="todo" tabindex="3" checked><label class="form-check-label" for="todo-radio">Todo</label></div><div class="form-check form-check-inline"><input type="radio" class="form-check-input" name="entry_status" value="pending" tabindex="4"><label class="form-check-label" for="pending-radio">Pending</label></div><div class="form-check form-check-inline"><input type="radio" class="form-check-input" name="entry_status" value="done" tabindex="5"><label class="form-check-label" for="done-radio">Done</label></div></div><div class="modal-footer"><button type="submit" class="btn btn-dark" data-bs-dismiss="modal" tabindex="6">Submit</button></div></form></div></div></div></div>`.replace(/\\"/g,'"'));break;case"done":o.push(`<div class="col ${h} done entry" translate="off" data-id="${t}" ${b}><div class="row"><div class="col-6"><div class="entry-category text-center text-uppercase bg-secondary"><p class="entry-category-text fw-bold text-white">${escapeOutput(r)}</p></div></div><div class="col-6">${u}</div></div><div class="entry-header text-sm-start text-wrap"><p class="entry-header-text fs-5 text-black">${escapeOutput(c)}</p></div><div class="entry-actions text-end"><div class="row"><div class="col-4 created-at text-start"><p class="date-created-text text-sm-start fw-bold text-white-50">&nbsp;&nbsp;${p}</p>${m}</div><div class="col-8"><button type="button" class="btn btn-done-create-child btn-sm refresh ${_}" data-id="${t}" data-entry-category="${escapeOutput(r)}" data-entry-status="${escapeOutput(i)}" data-entry-priority="${escapeOutput(n)}" title="Create Child Entry"><i class="btn-create-child-text fas fa-level-down-alt"></i></button><button type="button" class="btn btn-edit btn-sm refresh" data-bs-toggle="modal" data-bs-target="#modal-done-${t}" title="Edit Entry"><i class="btn-edit-text fas fa-edit"></i></button><button type="button" class="btn btn-done-delete btn-sm refresh" data-id="${t}" title="Delete Entry"><i class="btn-delete-text fas fa-trash-alt"></i></button></div></div></div></div><div class="modal fade modal-edit" id="modal-done-${t}" tabindex="-1" aria-labelled-by="modal-done-${t}-label" aria-hidden="true"><div class="modal-dialog modal-dialog-centered" translate="yes""><div class="modal-content fw-bold"><div class="modal-header"><h5 class="modal-title" id="modal-done-${t}-label">Edit Entry</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><form class="edit-form" data-id="${t}"><div class="mb-3 text-start"><label for="entry_title" class="form-label">Entry Title</label><input type="text" class="form-control" id="entry_title" value="${escapeOutput(c)}" required tabindex="0" maxlength="60" placeholder="e.g. Entry Title"></div><div class="mb-3 text-start"><label for="entry_category" class="form-label">Entry Category</label><select class="form-select" id="entry_category" required><option value="control">control</option><option value="dp">data protection</option><option value="dr">disaster recovery</option><option value="event">event</option><option value="grc">governance/risk/compliance</option><option value="ir">incident response</option><option value="patch">patch</option><option value="privacy">privacy</option><option value="risk">risk</option><option value="test">test</option><option value="ta">training/awareness</option><option value="vulnerability">vulnerability</option></select></div><div class="mb-3 text-start"><label for="entry_priority" class="form-label">Entry Priority</label><select class="form-select" id="entry_priority" required><option value="low">low</option><option value="medium">medium</option><option value="high">high</option></select></div><div class="mb-3 text-start"><div class="form-check form-check-inline"><input type="radio" class="form-check-input" name="entry_status" value="todo" tabindex="3" checked><label class="form-check-label" for="todo-radio">Todo</label></div><div class="form-check form-check-inline"><input type="radio" class="form-check-input" name="entry_status" value="pending" tabindex="4"><label class="form-check-label" for="pending-radio">Pending</label></div><div class="form-check form-check-inline"><input type="radio" class="form-check-input" name="entry_status" value="done" tabindex="5"><label class="form-check-label" for="done-radio">Done</label></div></div><div class="modal-footer"><button type="submit" class="btn btn-dark" data-bs-dismiss="modal" tabindex="6">Submit</button></div></form></div></div></div></div>`.replace(/\\"/g,'"'))}})),todo_count_text.textContent=`(${s.length}/${s.length+a.length+o.length})`,pending_count_text.textContent=`(${a.length}/${s.length+a.length+o.length})`,done_count_text.textContent=`(${o.length}/${s.length+a.length+o.length})`,0===s.length&&s.push('<div class="alert alert-danger fade show" role="alert"><strong>List is empty.</strong></div>'.replace(/\\"/g,'"')),0===a.length&&a.push('<div class="alert alert-danger fade show" role="alert"><strong>List is empty.</strong></div>'.replace(/\\"/g,'"')),0===o.length&&o.push('<div class="alert alert-danger fade show" role="alert"><strong>List is empty.</strong></div>'.replace(/\\"/g,'"')),entries_list_todo.innerHTML=s.join(" "),entries_list_pending.innerHTML=a.join(" "),entries_list_done.innerHTML=o.join(" "),Array.prototype.slice.call(document.querySelectorAll(".entry")).forEach((e=>{void 0===e.dataset.parent&&(e.addEventListener("mouseenter",(()=>{Array.prototype.slice.call(document.querySelectorAll(".entry")).forEach((t=>{void 0!==t.dataset.parent&&t.dataset.parent===e.dataset.id&&t.classList.add("child-entry-hover")}))})),e.addEventListener("mouseleave",(()=>{Array.prototype.slice.call(document.querySelectorAll(".entry")).forEach((t=>{void 0!==t.dataset.parent&&t.dataset.parent===e.dataset.id&&t.classList.remove("child-entry-hover")}))})))})),Array.prototype.slice.call(document.querySelectorAll(".edit-form")).forEach((e=>{e.addEventListener("submit",(t=>{t.preventDefault();let s={};Array.prototype.slice.call(e.elements).forEach((e=>{switch(e.id){case"entry_title":s.entry_title=e.value;break;case"entry_category":s.entry_category=e.value;break;case"entry_priority":s.entry_priority=e.value}if("entry_status"===e.name)e.checked&&(s.entry_status=e.value)})),s._csrf=token,editEntry(e.dataset.id,s)}))})),Array.prototype.slice.call(document.querySelectorAll(".btn-todo-create-child")).forEach((e=>{e.addEventListener("click",(()=>{createChild(e.dataset.id,e.dataset.entryCategory,e.dataset.entryStatus,e.dataset.entryPriority)}))})),Array.prototype.slice.call(document.querySelectorAll(".btn-pending-create-child")).forEach((e=>{e.addEventListener("click",(()=>{createChild(e.dataset.id,e.dataset.entryCategory,e.dataset.entryStatus,e.dataset.entryPriority)}))})),Array.prototype.slice.call(document.querySelectorAll(".btn-done-create-child")).forEach((e=>{e.addEventListener("click",(()=>{createChild(e.dataset.id,e.dataset.entryCategory,e.dataset.entryStatus,e.dataset.entryPriority)}))})),Array.prototype.slice.call(document.querySelectorAll(".btn-todo-delete")).forEach((e=>{e.addEventListener("click",(()=>deleteEntry(e.dataset.id)))})),Array.prototype.slice.call(document.querySelectorAll(".btn-pending-delete")).forEach((e=>{e.addEventListener("click",(()=>deleteEntry(e.dataset.id)))})),Array.prototype.slice.call(document.querySelectorAll(".btn-done-delete")).forEach((e=>{e.addEventListener("click",(()=>deleteEntry(e.dataset.id)))}))},editEntry=async(e,t)=>{await axios.patch(`/api/entries/${e}`,t).then((e=>{showAlertSuccess(e.data.msg),getAllEntries()})).catch((e=>showAlertFailure(e.response.data.msg)))},deleteEntry=async e=>{await axios.delete(`/api/entries/${e}`,{data:{_csrf:token}}).then((e=>{showAlertSuccess(e.data.msg),getAllEntries()})).catch((e=>showAlertFailure(e.response.data.msg)))},createChild=async(e,t,s,a)=>{let o={entry_title:"Child",entry_category:t,entry_status:s,entry_priority:a,entry_depends_on:e};o._csrf=token,await axios.post("/api/entries",o).then((e=>{showAlertSuccess(e.data.msg),getAllEntries()})).catch((e=>showAlertFailure(e.response.data.msg)))},checkAuthenticated=async()=>{await axios.get("/api/auth/").then().catch((e=>{403!==e.response.status?(register_option.classList.remove("show"),register_option.classList.add("hide"),login_option.classList.remove("show"),login_option.classList.add("hide"),logout_option.classList.remove("hide"),logout_option.classList.add("show"),account_option.classList.remove("hide"),account_option.classList.add("show"),executive_summary_option.classList.remove("hide"),executive_summary_option.classList.add("show"),recent_activity_option.classList.remove("hide"),recent_activity_option.classList.add("show"),performance_option.classList.remove("hide"),performance_option.classList.add("show"),rss_feed_option.classList.remove("hide"),rss_feed_option.classList.add("show"),idleTimer(),window.addEventListener("mousemove",(()=>mouse_mov_counter=0))):(register_option.classList.remove("hide"),register_option.classList.add("show"),login_option.classList.remove("hide"),login_option.classList.add("show"),logout_option.classList.remove("show"),logout_option.classList.add("hide"),account_option.classList.remove("show"),account_option.classList.add("hide"),executive_summary_option.classList.remove("show"),executive_summary_option.classList.add("hide"),recent_activity_option.classList.remove("show"),recent_activity_option.classList.add("hide"),performance_option.classList.remove("show"),performance_option.classList.add("hide"),rss_feed_option.classList.remove("show"),rss_feed_option.classList.add("hide"),void 0!==idleTimer&&clearInterval(idle_interval))}))},checkAuthenticatedTicketsView=async()=>{await axios.get("/api/auth/").then().catch((e=>{403!==e.response.status?(ticket_actions_header.classList.remove("hide"),ticket_actions_header.classList.add("show"),Array.prototype.slice.call(document.querySelectorAll(".ticket-actions")).forEach((e=>{e.classList.remove("hide")})),tickets_summary_section.classList.remove("hide"),tickets_form_open_state=!0):(ticket_actions_header.classList.remove("show"),ticket_actions_header.classList.add("hide"),Array.prototype.slice.call(document.querySelectorAll(".ticket-actions")).forEach((e=>{e.classList.add("hide")})),tickets_summary_section.classList.add("hide"),tickets_form_open_state=!1,tickets_table.addEventListener("click",(()=>{!0!==tickets_form_open_state&&1===page_num_tickets&&(tickets_list.insertAdjacentHTML("afterbegin",'<tr id="tickets-form-row" class="align-middle"><td class="align-middle"><form id="ticket-create-form"><div class="mb-3 text-start ticket-input"><div class="input-group input-group-sm mb-3 ticket-input"><button id="create-ticket-btn" class="btn btn-success" type="submit"><i class="fas fa-plus"></i></button><input type="text" inputmode="text" class="form-control form-control-sm" id="ticket_title" name="ticket_title" placeholder="Ticket Title..."></div></div></form></td><td><select class="form-select form-select-sm" id="ticket_priority"><option value="low" selected>low</option><option value="medium">medium</option><option value="high">high</option></select></td></tr>'),tickets_form_open_state=!0,document.querySelector("#create-ticket-btn").addEventListener("click",(()=>{document.querySelector("#ticket-create-form").addEventListener("submit",(async e=>{e.preventDefault();let t={};Array.prototype.slice.call(document.querySelector("#ticket-create-form").elements).forEach((e=>{if("ticket_title"===e.id)t.ticket_title=e.value})),t.ticket_priority=document.querySelector("#ticket_priority").value,t._csrf=token,document.querySelector("#ticket-create-form").reset(),await axios.post("/api/tickets",t).then((e=>{showAlertSuccess(e.data.msg),getTickets(),tickets_form_open_state=!1})).catch((e=>showAlertFailure(e.response.data.msg)))}))})))})),0===tickets_length&&(tickets_list.innerHTML="",tickets_table.click()))}))},idleTimer=()=>{idle_interval=setInterval((()=>{mouse_mov_counter++,10===mouse_mov_counter?showAlertFailure("Because you are idle, you will be deauthenticated in 5 minutes. Please move your mouse to stay logged in."):mouse_mov_counter>15&&(clearInterval(idle_interval),logout_option.click())}),6e4)};window.addEventListener("mousemove",(()=>mouse_mov_counter=0)),add_form.addEventListener("submit",(async e=>{e.preventDefault();let t={};Array.prototype.slice.call(add_form.elements).forEach((e=>{switch(e.id){case"entry_title":t.entry_title=e.value;break;case"entry_category":t.entry_category=e.value;break;case"entry_priority":t.entry_priority=e.value}if("entry_status"===e.name)e.checked&&(t.entry_status=e.value)})),t._csrf=token,add_form.reset(),await axios.post("/api/entries",t).then((e=>{showAlertSuccess(e.data.msg),getAllEntries()})).catch((e=>showAlertFailure(e.response.data.msg)))})),filter_form.addEventListener("submit",(async e=>{e.preventDefault(),params.entry_category=[],params.entry_priority=[],Array.prototype.slice.call(filter_form.elements).forEach((e=>{switch(e.name){case"entry_category_filter":if(e.checked)switch(e.value){case"control":case"dp":case"dr":case"event":case"grc":case"ir":case"patch":case"privacy":case"risk":case"test":case"ta":case"vulnerability":params.entry_category.push(e.value)}break;case"entry_priority_filter":if(e.checked)switch(e.value){case"low":case"medium":case"high":params.entry_priority.push(e.value)}break;case"entry_search_expr":params.entry_search=e.value}})),0===params.entry_category.length&&params.entry_category.push("notapplicable"),0===params.entry_priority.length&&params.entry_priority.push("notapplicable"),getAllEntries(params)})),login_form.addEventListener("submit",(async e=>{e.preventDefault();let t={};Array.prototype.slice.call(login_form.elements).forEach((e=>{switch(e.id){case"login-username":t.username=e.value;break;case"login-password":t.password=e.value}})),t._csrf=token,login_form.reset(),await axios.post("/api/auth/login",t).then((e=>{showAlertSuccess(e.data.msg),checkAuthenticated(),getCsrfToken()})).catch((e=>showAlertFailure(e.response.data.msg)))})),register_form.addEventListener("submit",(async e=>{e.preventDefault();let t={};Array.prototype.slice.call(register_form.elements).forEach((e=>{switch(e.id){case"register-username":t.username=e.value;break;case"register-password":t.password=e.value}})),register_form.reset(),await axios.post("/api/auth/register",t).then((e=>showAlertSuccess(e.data.msg))).catch((e=>showAlertFailure(e.response.data.msg)))})),account_form.addEventListener("submit",(async e=>{e.preventDefault();let t={};Array.prototype.slice.call(account_form.elements).forEach((e=>{if("change-password"===e.id)t.password=e.value})),t._csrf=token,account_form.reset(),await axios.patch("/api/users/changepassword",t).then((e=>showAlertSuccess(e.data.msg))).catch((e=>showAlertFailure(e.response.data.msg)))})),logout_option.addEventListener("click",(async()=>{await axios.get("/api/auth/logout",{params:{_csrf:token}}).then((e=>{showAlertSuccess(e.data.msg),account_submenu.classList.remove("show"),checkAuthenticated()})).catch((e=>showAlertFailure(e.response.data.msg)))})),delete_account_btn.addEventListener("click",(async()=>{await axios.delete("/api/users/delete",{data:{_csrf:token}}).then((e=>{showAlertSuccess(e.data.msg),logout_option.click()})).catch((e=>showAlertFailure(e.response.data.msg)))}));const showAlertSuccess=e=>{alert_banner.innerHTML=`<div class="alert alert-success alert-dismissible fade show" role="alert"><strong>${escapeOutput(e)}</strong></div>`,setTimeout((()=>alert_banner.innerHTML=""),4e3)},showAlertFailure=e=>{alert_banner.innerHTML=`<div class="alert alert-danger alert-dismissible fade show" role="alert"><strong>${escapeOutput(e)}</strong></div>`,setTimeout((()=>alert_banner.innerHTML=""),4e3)};show_login_password_btn.addEventListener("click",(()=>{let e=document.querySelector("#login-password");"password"===e.type?(show_login_password_btn.innerHTML='<i class="fas fa-eye"></i>',e.type="text"):(show_login_password_btn.innerHTML='<i class="fas fa-eye-slash"></i>',e.type="password")})),show_register_password_btn.addEventListener("click",(()=>{let e=document.querySelector("#register-password");"password"===e.type?(show_register_password_btn.innerHTML='<i class="fas fa-eye"></i>',e.type="text"):(show_register_password_btn.innerHTML='<i class="fas fa-eye-slash"></i>',e.type="password")})),show_change_password_btn.addEventListener("click",(()=>{let e=document.querySelector("#change-password");"password"===document.querySelector("#change-password").type?(show_change_password_btn.innerHTML='<i class="fas fa-eye"></i>',e.type="text"):(show_change_password_btn.innerHTML='<i class="fas fa-eye-slash"></i>',e.type="password")}));const getRecentActivity=async()=>{let e={page_num:page_num??1,_csrf:token},t=[];const{data:s}=await axios.get("/api/logs",{params:e});logs_length=s.logs_count,s.logs_list.map((e=>{const{user:s,action:a,createdAt:o}=e;let c=`${Math.trunc(((new Date).getTime()-new Date(o).getTime())/864e5)}d`;switch(a){case"created":t.push(`<tr class="align-middle"><td class="table-success"><i class="icon-text text-black fw-bold fas fa-plus"></i></td><td><p class="activity-text text-black fw-bold">${escapeOutput(s)} ${escapeOutput(a)} an entry</p></td></td><td><p class="log-date-text fw-bold text-secondary">${c}</p></td></tr>`.replace(/\\"/g,'"'));break;case"modified":t.push(`<tr class="align-middle"><td class="table-warning"><i class="icon-text align-middle text-black fw-bold fas fa-tools"></i></td><td><p class="activity-text text-black fw-bold">${escapeOutput(s)} ${escapeOutput(a)} an entry</p></td><td><p class="log-date-text fw-bold text-secondary">${c}</p></td></tr>`.replace(/\\"/g,'"'));break;case"deleted":t.push(`<tr class="align-middle"><td class="table-danger"><i class="icon-text align-middle text-black fw-bold fas fa-times"></i></td><td><p class="activity-text text-black fw-bold">${escapeOutput(s)} ${escapeOutput(a)} an entry</p></td><td><p class="log-date-text fw-bold text-secondary">${c}</p></td></tr>`.replace(/\\"/g,'"'))}})),0===t.length&&t.push('<tr class="align-middle"><td><div class="alert alert-danger fade show" role="alert"><strong>No recent activity.</strong></div></td></tr>'.replace(/\\"/g,'"')),logs_list.innerHTML=t.join(" ")};recent_activity_option.addEventListener("click",(()=>{page_num=1,logs_page_num.textContent=`Page ${escapeOutput(page_num)}`,getRecentActivity()})),recent_activity_option.addEventListener("click",(()=>{page_num=1,logs_page_num.textContent=`Page ${escapeOutput(page_num)}`,getRecentActivity()})),logs_prev_btn.addEventListener("click",(()=>{page_num<=Math.ceil(logs_length/5)+1&&page_num>1&&page_num--,logs_page_num.textContent=`Page ${escapeOutput(page_num)}`,getRecentActivity()})),logs_next_btn.addEventListener("click",(()=>{page_num<=Math.floor(logs_length/5)&&page_num++,logs_page_num.textContent=`Page ${escapeOutput(page_num)}`,getRecentActivity()})),performance_representation.addEventListener("change",(()=>{switch(performance_representation.value){case"chart":case"tabular":performance_representation_value=performance_representation.value}getPerformanceOverview()}));const createChart=e=>{let t,s,a;if(document.querySelector("#performance-plot").innerHTML="",0!==Object.values(e)[0]||0!==Object.values(e)[1]||0!=Object.values(e)[2]){switch(performance_representation_value){case"chart":t=google.visualization.arrayToDataTable([["Activity","Frequency"],["Created",Object.values(e)[0]],["Modified",Object.values(e)[1]],["Deleted",Object.values(e)[2]]]),s=new google.visualization.PieChart(document.querySelector("#performance-plot")),a={title:"Actions Summary",is3D:!0};break;case"tabular":let o={headerRow:"chart-header-text",tableRow:"",oddTableRow:"",selectedTableRow:"",hoverTableRow:"",headerCell:"",tableCell:"chart-table-row-text",rowNumberCell:""};t=google.visualization.arrayToDataTable([["Activity","Frequency"],["Created",Object.values(e)[0]],["Modified",Object.values(e)[1]],["Deleted",Object.values(e)[2]]]),s=new google.visualization.Table(document.querySelector("#performance-plot")),a={title:"Actions Summary",width:"100%",height:"100%",allowHtml:!0,cssClassNames:o}}s.draw(t,a)}else document.querySelector("#performance-plot").innerHTML='<div class="alert alert-danger alert-dismissible fade show" role="alert"><strong>No data available.</strong></div>'},getPerformanceOverview=async()=>{performance_created_score.innerHTML="",performance_modified_score.innerHTML="",performance_deleted_score.innerHTML="";const{data:{user_performance:e,user_performance_averages:t}}=await axios.get("/api/logs/performance",{params:{_csrf:token}});let s=0,a=0,o=0;[s,a,o]=Object.values(e),s>t.created?performance_created_score.insertAdjacentHTML("beforeend",`<p class="text-black fw-bold fs-3">${s}&nbsp;&nbsp;<i class="text-success fas fa-angle-up"></i></p>`):s===t.created?performance_created_score.insertAdjacentHTML("beforeend",`<p class="text-black fw-bold fs-3">${s}&nbsp;&nbsp;<i class="fas text-warning fa-minus"></i></p>`):s<t.created&&performance_created_score.insertAdjacentHTML("beforeend",`<p class="text-black fw-bold fs-3">${s}&nbsp;&nbsp;<i class="text-danger fas fa-angle-down"></i></p>`),a>t.modified?performance_modified_score.insertAdjacentHTML("beforeend",`<p class="text-black fw-bold fs-3">${a}&nbsp;&nbsp;<i class="text-success fas fa-angle-up"></i></p>`):a===t.modified?performance_modified_score.insertAdjacentHTML("beforeend",`<p class="text-black fw-bold fs-3">${a}&nbsp;&nbsp;<i class="fas text-warning fa-minus"></i></p>`):a<t.modified&&performance_modified_score.insertAdjacentHTML("beforeend",`<p class="text-black fw-bold fs-3">${a}&nbsp;&nbsp;<i class="text-danger fas fa-angle-down"></i></p>`),o>t.deleted?performance_deleted_score.insertAdjacentHTML("beforeend",`<p class="text-black fw-bold fs-3">${o}&nbsp;&nbsp;<i class="text-success fas fa-angle-up"></i></p>`):o===t.deleted?performance_deleted_score.insertAdjacentHTML("beforeend",`<p class="text-black fw-bold fs-3">${o}&nbsp;&nbsp;<i class="fas text-warning fa-minus"></i></p>`):o<t.deleted&&performance_deleted_score.insertAdjacentHTML("beforeend",`<p class="text-black fw-bold fs-3">${o}&nbsp;&nbsp;<i class="text-danger fas fa-angle-down"></i></p>`),createChart(e)};performance_option.addEventListener("click",(()=>{performance_created_score.innerHTML="",performance_modified_score.innerHTML="",performance_deleted_score.innerHTML="",getPerformanceOverview()}));const getRSSFeed=async e=>{let t={};t=void 0===e&&typeof e!==Object?{}:e,t._csrf=token;const{data:s}=await axios.get("/api/rss/",{params:t}).then().catch((e=>rss_list.innerHTML=`<tr class="align-middle"><td><div class="alert alert-danger fade show" role="alert"><strong>${escapeOutput(e.response.data.msg)}</strong></div></td></tr>`));rss_data=s.rss_feed.items,rss_length=s.rss_feed.items.length,rss_source_text.textContent=`Source: ${escapeOutput(s.rss_title)}`},bufferRSSFeed=async()=>rss_list.innerHTML='<tr class="align-middle"><td><p class="text-black"><i class="fas fa-spinner fa-spin"></i></p></td></tr>',updateRSSFeed=()=>{let e=[],t=3*(page_num_rss-1),s=t+3,a=1;rss_data.slice(t,s).map((t=>{const{title:s,contentSnippet:o,link:c,isoDate:r}=t;let i=`${Math.trunc(((new Date).getTime()-new Date(r).getTime())/864e5)}d`;e.push(`<tr class="align-middle"><td><div class="front show" data-id="${a}"><p class="rss-title-text text-black fw-normal">${escapeOutput(s)}</p></div><div class="back hide" data-id="${a}"><p class="rss-description-text text-black fw-bold">${escapeOutput(o)}</p><p class="rss-link-text fw-normal"><a class="link-primary" href="${escapeOutput(c)}" target="_blank">Show more</a></p></div></td><td class="align-middle"><p class="rss-date-text fw-bold text-secondary">${i}</p></td><td><button class="btn btn-light btn-rss-show" data-id="${a}"><i class="fas fa-angle-down"></i></button></td></tr>`),a++})),0===e.length&&e.push('<tr class="align-middle"><td><div class="alert alert-danger fade show" role="alert"><strong>No recent news.</strong></div></td></tr>'.replace(/\\"/g,'"')),rss_list.innerHTML=e.join(" "),Array.prototype.slice.call(document.querySelectorAll(".btn-rss-show")).forEach((e=>{let t=!1;e.innerHTML='<i class="fas fa-angle-up"></i>',e.addEventListener("click",(()=>{Array.prototype.slice.call(document.querySelectorAll(".front")).forEach((s=>{Array.prototype.slice.call(document.querySelectorAll(".back")).forEach((a=>{e.dataset.id===s.dataset.id&&e.dataset.id===a.dataset.id&&(t?(t=!1,e.innerHTML='<i class="fas fa-angle-up"></i>',s.classList.remove("hide"),s.classList.add("show"),a.classList.remove("show"),a.classList.add("hide")):(t=!0,e.innerHTML='<i class="fas fa-angle-down"></i>',s.classList.remove("show"),s.classList.add("hide"),a.classList.remove("hide"),a.classList.add("show")))}))}))}))}))};rss_feed_option.addEventListener("click",(async()=>{page_num_rss=1,rss_page_num.textContent=`Page ${escapeOutput(page_num_rss)}`,bufferRSSFeed(),await getRSSFeed(),updateRSSFeed()})),rss_feed_form.addEventListener("submit",(async e=>{e.preventDefault();let t={};Array.prototype.slice.call(rss_feed_form.elements).forEach((e=>{if("rss-search"===e.id)t.pref_rss_source=e.value})),t._csrf=token,rss_feed_form.reset(),await axios.patch("/api/rss/changesource",t).then((async e=>{showAlertSuccess(e.data.msg),bufferRSSFeed(),await getRSSFeed(),updateRSSFeed()})).catch((e=>showAlertFailure(e.response.data.msg)))})),rss_search_form.addEventListener("submit",(async e=>{e.preventDefault();let t={};Array.prototype.slice.call(rss_search_form.elements).forEach((e=>{if("rss-search-expr"===e.id)t.rss_search=e.value})),rss_search_form.reset(),page_num_rss=1,rss_page_num.textContent=`Page ${escapeOutput(page_num_rss)}`,bufferRSSFeed(),await getRSSFeed(t),updateRSSFeed()})),rss_prev_btn.addEventListener("click",(()=>{page_num_rss<=Math.ceil(rss_length/3)+1&&page_num_rss>1&&page_num_rss--,rss_page_num.textContent=`Page ${escapeOutput(page_num_rss)}`,updateRSSFeed()})),rss_next_btn.addEventListener("click",(()=>{page_num_rss<=Math.floor(rss_length/3)&&page_num_rss++,rss_page_num.textContent=`Page ${escapeOutput(page_num_rss)}`,updateRSSFeed()}));const getTickets=async()=>{let e={page_num:page_num_tickets??1},t=[];tickets_open_score.innerHTML="",tickets_new_score.innerHTML="",tickets_rejected_score.innerHTML="",tickets_resolved_score.innerHTML="";const{data:s}=await axios.get("/api/tickets",{params:e});tickets_length=s.tickets_count,s.tickets_list.map((e=>{const{_id:s,ticket_title:a,ticket_status:o,ticket_priority:c,createdAt:r}=e;Math.trunc(((new Date).getTime()-new Date(r).getTime())/864e5);let i="";switch(c){case"low":i=`<div class="ticket-priority text-center text-uppercase"><p class="ticket-priority-text low fw-bold text-white">${escapeOutput(c)}</p></div>`;break;case"medium":i=`<div class="ticket-priority text-center text-uppercase"><p class="ticket-priority-text medium fw-bold text-white">${escapeOutput(c)}</p></div>`;break;case"high":i=`<div class="ticket-priority text-center text-uppercase"><p class="ticket-priority-text high fw-bold text-white">${escapeOutput(c)}</p></div>`}switch(o){case"new":t.push(`<tr class="align-middle"><td><div class="container-fluid"><p class="ticket-title-text text-black fw-normal"><span class="ticket-id link-primary">#${s.substring(s.length-4,s.length)}&nbsp;&nbsp;</span>${escapeOutput(a)}</p></div></td><td class="align-middle"><div class="row"><div class="col status d-flex"><div class="ticket-status text-center text-uppercase"><p class="ticket-status-text new fw-bold text-white">${escapeOutput(o)}</p></div></div><div class="col priority d-flex">${i}</div></div></td><td class="align-middle ticket-actions hide"><button class="btn btn-accept-ticket" data-id="${s}" title="Accept Ticket"><i class="fas fa-check btn-reject-ticket-text"></i></button><button class="btn btn-reject-ticket" data-id="${s}" title="Reject Ticket"><i class="fas fa-times btn-reject-ticket-text"></i></button></td></tr>`.replace(/\\"/g,'"'));break;case"open":t.push(`<tr class="align-middle"><td><div class="container-fluid"><p class="ticket-title-text text-black fw-normal"><span class="ticket-id link-primary">#${s.substring(s.length-4,s.length)}&nbsp;&nbsp;</span>${escapeOutput(a)}</p></div></td><td class="align-middle"><div class="row"><div class="col status d-flex"><div class="ticket-status text-center text-uppercase"><p class="ticket-status-text open fw-bold text-white">${escapeOutput(o)}</p></div></div><div class="col priority d-flex">${i}</div></div></td><td class="align-middle ticket-actions hide"><button class="btn btn-resolve-ticket" data-id="${s}" title="Mark as Resolved"><i class="fas fa-check btn-resolve-ticket-text"></i></button><button class="btn btn-unaccept-ticket" data-id="${s}" title="Un-accept Ticket"><i class="fas fa-undo"></i></button></td></tr>`.replace(/\\"/g,'"'));break;case"resolved":t.push(`<tr class="align-middle"><td><div class="container-fluid"><p class="ticket-title-text text-black fw-normal"><span class="ticket-id link-primary">#${s.substring(s.length-4,s.length)}&nbsp;&nbsp;</span>${escapeOutput(a)}</p></div></td><td class="align-middle"><div class="row"><div class="col status d-flex"><div class="ticket-status text-center text-uppercase"><p class="ticket-status-text resolved fw-bold text-white">${escapeOutput(o)}</p></div></div><div class="col priority d-flex">${i}</div></div></td><td class="align-middle ticket-actions hide"><button class="btn btn-unresolve-ticket" data-id="${s}" title="Un-resolve Ticket"><i class="fas fa-undo"></i></button><button class="btn btn-delete-ticket" data-id="${s}" title="Delete Resolved Ticket"><i class="fas fa-trash-alt"></i></button></td></tr>`.replace(/\\"/g,'"'));break;case"rejected":t.push(`<tr class="align-middle"><td><div class="container-fluid"><p class="ticket-title-text text-black fw-normal"><span class="ticket-id text link-primary">#${s.substring(s.length-4,s.length)}&nbsp;&nbsp;</span>${escapeOutput(a)}</p></div></td><td class="align-middle"><div class="row"><div class="col status d-flex"><div class="ticket-status text-center text-uppercase"><p class="ticket-status-text rejected fw-bold text-white">${escapeOutput(o)}</p></div></div><div class="col priority d-flex">${i}</div></div></td><td class="align-middle ticket-actions hide"><button class="btn btn-unreject-ticket" data-id="${s}" title="Un-reject Ticket"><i class="fas fa-undo"></i></button><button class="btn btn-delete-ticket" data-id="${s}" title="Delete Rejected Ticket"><i class="fas fa-trash-alt"></i></button></td></tr>`.replace(/\\"/g,'"'))}})),tickets_list.innerHTML=t.join(" "),Array.prototype.slice.call(document.querySelectorAll(".btn-accept-ticket")).forEach((e=>{e.addEventListener("click",(()=>{acceptTicket(e.dataset.id)}))})),Array.prototype.slice.call(document.querySelectorAll(".btn-unaccept-ticket")).forEach((e=>{e.addEventListener("click",(()=>{unacceptTicket(e.dataset.id)}))})),Array.prototype.slice.call(document.querySelectorAll(".btn-reject-ticket")).forEach((e=>{e.addEventListener("click",(()=>{rejectTicket(e.dataset.id)}))})),Array.prototype.slice.call(document.querySelectorAll(".btn-unreject-ticket")).forEach((e=>{e.addEventListener("click",(()=>{unrejectTicket(e.dataset.id)}))})),Array.prototype.slice.call(document.querySelectorAll(".btn-resolve-ticket")).forEach((e=>{e.addEventListener("click",(()=>{resolveTicket(e.dataset.id)}))})),Array.prototype.slice.call(document.querySelectorAll(".btn-unresolve-ticket")).forEach((e=>{e.addEventListener("click",(()=>{unresolveTicket(e.dataset.id)}))})),Array.prototype.slice.call(document.querySelectorAll(".btn-delete-ticket")).forEach((e=>{e.addEventListener("click",(()=>{deleteTicket(e.dataset.id)}))})),tickets_open_score.insertAdjacentHTML("beforeend",`<p class="text-black fw-bold fs-5">${s.tickets_status_count.open}</p>`),tickets_new_score.insertAdjacentHTML("beforeend",`<p class="text-black fw-bold fs-5">${s.tickets_status_count.new}</p>`),tickets_rejected_score.insertAdjacentHTML("beforeend",`<p class="text-black fw-bold fs-5">${s.tickets_status_count.rejected}</p>`),tickets_resolved_score.insertAdjacentHTML("beforeend",`<p class="text-black fw-bold fs-5">${s.tickets_status_count.resolved}</p>`),checkAuthenticatedTicketsView()},acceptTicket=async e=>{await axios.patch(`/api/tickets/${e}`,{ticket_status:"open",_csrf:token}).then((e=>{showAlertSuccess(e.data.msg),getTickets()})).catch((e=>showAlertFailure(e.response.data.msg)))},unacceptTicket=async e=>{await axios.patch(`/api/tickets/${e}`,{ticket_status:"new",_csrf:token}).then((e=>{showAlertSuccess(e.data.msg),getTickets()})).catch((e=>showAlertFailure(e.response.data.msg)))},rejectTicket=async e=>{await axios.patch(`/api/tickets/${e}`,{ticket_status:"rejected",_csrf:token}).then((e=>{showAlertSuccess(e.data.msg),getTickets()})).catch((e=>showAlertFailure(e.response.data.msg)))},unrejectTicket=async e=>{await axios.patch(`/api/tickets/${e}`,{ticket_status:"new",_csrf:token}).then((e=>{showAlertSuccess(e.data.msg),getTickets()})).catch((e=>showAlertFailure(e.response.data.msg)))},resolveTicket=async e=>{await axios.patch(`/api/tickets/${e}`,{ticket_status:"resolved",_csrf:token}).then((e=>{showAlertSuccess(e.data.msg),getTickets()})).catch((e=>showAlertFailure(e.response.data.msg)))},unresolveTicket=async e=>{await axios.patch(`/api/tickets/${e}`,{ticket_status:"open",_csrf:token}).then((e=>{showAlertSuccess(e.data.msg),getTickets()})).catch((e=>showAlertFailure(e.response.data.msg)))},deleteTicket=async e=>{await axios.delete(`/api/tickets/${e}`,{data:{_csrf:token}}).then((e=>{showAlertSuccess(e.data.msg),getTickets()})).catch((e=>showAlertFailure(e.response.data.msg)))};ticket_option.addEventListener("click",(async()=>{page_num_tickets=1,tickets_page_num.textContent=`Page ${escapeOutput(page_num_tickets)}`,null!==document.querySelector("#tickets-form-row")&&(document.querySelector("#tickets-form-row").remove(),tickets_form_open_state=!1),getTickets()})),tickets_prev_btn.addEventListener("click",(()=>{page_num_tickets<=Math.ceil(tickets_length/5)+1&&page_num_tickets>1&&page_num_tickets--,tickets_page_num.textContent=`Page ${escapeOutput(page_num_tickets)}`,getTickets()})),tickets_next_btn.addEventListener("click",(()=>{page_num_tickets<=Math.floor(tickets_length/5)&&page_num_tickets++,tickets_page_num.textContent=`Page ${escapeOutput(page_num_tickets)}`,getTickets()})),hide_sidebar_btn.addEventListener("click",(()=>{sidebar.classList.contains("hide")?(sidebar.classList.remove("hide"),sidebar.classList.add("show"),columns_row.classList.remove("justify-content-center"),columns_row.classList.add("justify-content-start"),mob_screen.matches||(todo_column.classList.remove("col-sm-4"),pending_column.classList.remove("col-sm-4"),done_column.classList.remove("col-sm-4"),todo_column.classList.add("col-sm-3"),pending_column.classList.add("col-sm-3"),done_column.classList.add("col-sm-3")),hide_sidebar_btn.innerHTML='<i class="fas fa-chevron-left">'):(sidebar.classList.remove("show"),sidebar.classList.add("hide"),columns_row.classList.remove("justify-content-start"),columns_row.classList.add("justify-content-center"),todo_column.classList.remove("col-sm-3"),pending_column.classList.remove("col-sm-3"),done_column.classList.remove("col-sm-3"),todo_column.classList.add("col-sm-4"),pending_column.classList.add("col-sm-4"),done_column.classList.add("col-sm-4"),hide_sidebar_btn.innerHTML='<i class="fas fa-chevron-right">')})),category_checkall_check.addEventListener("change",(()=>{category_checkall_check.checked?category_checkboxes.forEach((e=>e.checked=!0)):category_checkboxes.forEach((e=>e.checked=!1))})),priority_checkall_check.addEventListener("change",(()=>{priority_checkall_check.checked?priority_checkboxes.forEach((e=>e.checked=!0)):priority_checkboxes.forEach((e=>e.checked=!1))})),category_checkboxes.forEach((e=>e.addEventListener("change",(()=>e.checked?null:category_checkall_check.checked=!1)))),priority_checkboxes.forEach((e=>e.addEventListener("change",(()=>e.checked?null:priority_checkall_check.checked=!1)))),append_epoch_check.addEventListener("change",(()=>{!0===append_epoch_check.checked&&(filename_field.value+=`-${parseInt((new Date).getTime()/1e3)}`,append_epoch_check.disabled=!0)})),filter_entries_link.addEventListener("click",(()=>{view_more_less.classList.remove("hide"),view_more_less.classList.add("add"),entry_categories_more.classList.remove("show"),entry_categories_more.classList.add("hide")})),view_more_less.addEventListener("click",(()=>{view_more_less.classList.remove("add"),view_more_less.classList.add("hide"),entry_categories_more.classList.remove("hide"),entry_categories_more.classList.add("show")})),mob_screen_small.addEventListener("change",(()=>{mob_screen_small.matches||window.scrollTo({top:0,behavior:"smooth"})})),mob_screen.addEventListener("change",(()=>{mob_screen.matches?(document.querySelectorAll(".btn-close").forEach((e=>e.click())),"col-sm-3"===todo_column.classList[0]&&"col-sm-3"===pending_column.classList[0]&&"col-sm-3"===done_column.classList[0]?(col_3_prev_state=!0,sidebar.classList.contains("show")&&(sidebar.classList.remove("show"),sidebar.classList.add("hide")),todo_column.classList.remove("col-sm-3"),pending_column.classList.remove("col-sm-3"),done_column.classList.remove("col-sm-3"),todo_column.classList.add("col-sm-4"),pending_column.classList.add("col-sm-4"),done_column.classList.add("col-sm-4")):(col_3_prev_state=!1,sidebar.classList.contains("show")&&(sidebar.classList.remove("show"),sidebar.classList.add("hide")),todo_column.classList.remove("col-sm-4"),pending_column.classList.remove("col-sm-4"),done_column.classList.remove("col-sm-4"),todo_column.classList.add("col-sm-4"),pending_column.classList.add("col-sm-4"),done_column.classList.add("col-sm-4"))):!0===col_3_prev_state?(sidebar.classList.contains("show")?(sidebar.classList.remove("show"),sidebar.classList.add("hide")):(sidebar.classList.remove("hide"),sidebar.classList.add("show")),todo_column.classList.remove("col-sm-4"),pending_column.classList.remove("col-sm-4"),done_column.classList.remove("col-sm-4"),todo_column.classList.add("col-sm-3"),pending_column.classList.add("col-sm-3"),done_column.classList.add("col-sm-3")):(sidebar.classList.remove("show"),sidebar.classList.add("hide"))})),window.innerWidth<=800&&(col_3_prev_state=!1,todo_column.classList.remove("col-sm-3"),pending_column.classList.remove("col-sm-3"),done_column.classList.remove("col-sm-3"),todo_column.classList.add("col-sm-4"),pending_column.classList.add("col-sm-4"),done_column.classList.add("col-sm-4")),mob_up_btn.addEventListener("click",(()=>{switch(mob_scroll_pos){case 0:var e=200,t=document.querySelector(columns[mob_scroll_pos]).getBoundingClientRect().top+window.pageYOffset-e;window.scrollTo({top:t,behavior:"smooth"});break;case 1:mob_scroll_pos--;e=200,t=document.querySelector(columns[mob_scroll_pos]).getBoundingClientRect().top+window.pageYOffset-e;window.scrollTo({top:t,behavior:"smooth"});break;case 2:mob_scroll_pos--;e=200,t=document.querySelector(columns[mob_scroll_pos]).getBoundingClientRect().top+window.pageYOffset-e;window.scrollTo({top:t,behavior:"smooth"})}})),mob_down_btn.addEventListener("click",(()=>{switch(mob_scroll_pos){case 0:mob_scroll_pos++;var e=200,t=document.querySelector(columns[mob_scroll_pos]).getBoundingClientRect().top+window.pageYOffset-e;window.scrollTo({top:t,behavior:"smooth"});break;case 1:mob_scroll_pos++;e=200,t=document.querySelector(columns[mob_scroll_pos]).getBoundingClientRect().top+window.pageYOffset-e;window.scrollTo({top:t,behavior:"smooth"});break;case 2:e=200,t=document.querySelector(columns[mob_scroll_pos]).getBoundingClientRect().top+window.pageYOffset-e;window.scrollTo({top:t,behavior:"smooth"})}})),setInterval((()=>{let e=!0;document.querySelectorAll(".modal-edit").forEach((t=>t.classList.contains("show")?e=!1:null)),!0===e&&getAllEntries(params)}),2e3),window.onload=()=>{getAllEntries(params),checkAuthenticated(),getCsrfToken(),window.scrollTo({top:0,behavior:"smooth"}),window.focus(),append_epoch_check.checked=!1},window.onunload=async()=>await axios.get("/api/auth/logout",{params:{_csrf:token}});